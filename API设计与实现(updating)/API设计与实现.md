# Introduction

陈长兵

50% 平时分
50% 大作业

## 课程教材

<img src="API设计与实现.assets/image-20230304172113208.png" alt="image-20230304172113208" style="zoom:50%;" />

# 绪论

## API研究方法

### API位置

- 调用软件库的方法
- 与操作系统交互
- 与数据库交互
- 使用第三方提供的服务
- 通过网络调用服务
- ...

### API作用

- 提供软件之前交互的方法
- 开放能力，提供服务的一种方式
- 支持模块化
- 隐藏细节

### 行业发展需要

- 企业协作
- 大规模集成
- 开放式创新

### API面临的挑战

- 现代软件开发模式，迭代&敏捷
- 灵活性 & 开放性
- 刚性 & 脆弱性

# API设计概论

## API是什么

- 应用程序编程接口，不同计算机程序之间的通信交互方式
- 软件接口的一种，向软件的其他模块提供服务
- 两种形态，API规格说明书和API实现

## 为什么需要API

**隔离**

> - 屏蔽底层细节
> - 维持一致连贯性
> - 安全保障

**简化**

> - 避免重复造轮子

**抽象**

> - 建立契约，等价性
> - 突出行为，掩盖特征
> - 高内聚低耦合

**共享**

> - 服务标准化、产品化
> - 建立合作关系
> - 价值链延伸

## API分类

基于服务对象

> 公有型API
> 私有型API
> 混合型API

基于技术类型

> gRPC API
> SOAP API
> RESTful API
> GraphQL API

## API服务模式

### ESB

**企业服务总线Enterprise Service Bus**是连接个应用系统之间的中央枢纽
基于SOA(面向资源的体系架构)的设计思路，主流

### 微服务

MicroServices，由一组完全独立的应用服务构成，独自独立部署和松耦合交互，共同完成特定的业务需求

## API经济

企业与企业之间通过API建立合作关系  1

# API设计规范

## API设计评估

- Operational 可行，可用
- Expressive 富有表象，表达能力强
- Simple 简单，简洁
- Predictable 可预测性

## 通用设计原则

- 简单原则
  - 声明直观清晰
  - 功能可见性
  - 简单易用程度
  - 单一职责
- 抽象原则
  - 按业务特征抽象实体
  - 最小信息，接口粒度
  - 恰当的抽象与具体
  - 更好的适用性、拓展性
- 兼容扩展原则
  - 开闭原则
  - 保证API的后向兼容
  - 拓展参数便利
- 统一原则
  - 统一的命名规范
  - 统一的入/出参规范
  - 统一的错误码规范
  - 统一的版本规范 
- 正交原则
  - 覆盖全业务流程
  - MECE原则，相互独立&完全穷尽
  - 高内聚低耦合
- 安全原则
  - 认证授权，访问控制
  - API自身保护
  - 传输数据保护

## API设计原则

API构成

> - 操作
> - 参数
> - 组织结构

### 命令规则

#### 好的命名特点

- Expressive
- Simple
- Predictable

命名的机制

> - 一致性
>   - 美式英语&英式英语
> - 语法
>   - 命令式动词
>   - 介词
>   - 复数
> - 词法
>   - 大小写
>   - 关键词

#### 四种命名方法

- 帕斯卡命名法
  首字母大写，单词无连接
- 驼峰命名法
  - 小驼峰法，除第一单词外首字母
  - 大驼峰法，帕斯卡
- 下划线命名法
- 匈牙利命名法
  `构成=属性+类型+对象描述`

#### 其他考虑因素

- 上下文Context
  - 上下文携带信息，影响名字的含义
  - 限定含义，或赋予特有含义
- 数据类型和单位
  - 数据没有单位会引起混乱
  - 引入丰富的数据类型

### 数据类型和默认值

- 数据类型是每个编程语言的重要组成部分
- 动态类型，Dynamic Typing
- 序列化 & 反序列化， 信息丢失
- 缺失与空值

#### 布尔类型

- 一定应用场景
- 二值表达力有限，可能有更好的方案
- 避免double negative（双重否定）

#### 数值类型

- 存在算数计算诉求场景
- 不适用于纯数值类标识符
- 边界
- 默认值
- 序列化

#### 字符类型

- 最通用的数据类型
- 编码，byte & char & Character
- 边界
- 序列化
  标准等级与兼容等价，组合和独立字符两个维度

#### 枚举类型

Name(字符) + Value(数值)

优势：校验，压缩
不足：依赖码表，变更同步

**API场景传输时，优先字符类型**

#### 列表类型

- 基本类型的集合，也可以是其他列表或Map类型
- 原子性
- 边界
- 默认值

#### Map类型

- 边界
- 默认值

### 资源范围和层级

#### 资源布局

是一种实体关系模型，实体与实体之间的关系

- 关系的种类
  - 引用关系
  - Many-to-One关系
  - 自引用关系
  - 层级关系
- ER图

**如何选择正确的关系**

> - 是否需要建立一个关系
>   - 建立关系是有代价的，性能变差，维护复杂
>   - 关系也是有价值的，比如社交网络
>   - 新增关系 一定与 某个重要的业务需求挂钩
> - 使用引用reference还是内嵌in-line
>   - 引用方式：通过指针找到真实对象
>   - 内嵌方式：存储对象的全部数据
>   - 差异：交互次数，传输数据大小
>   - 考虑因素；具体场景具体看，需求意图，底层存储方式
> - 层级
>   - 层级关系or引用关系
>   - 层级关系特点：操作的级联性

# API设计模式



# API安全



# API技术实现