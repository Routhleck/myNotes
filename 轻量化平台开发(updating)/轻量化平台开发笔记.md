# Introduction

鲍亚运

小程序

平时作业 50%
大作业 50% (每组4-5人, 最后两节课展示)

# 第一个小程序

## 开发工具

[微信开发者工具（稳定版 Stable Build）下载地址与更新日志 | 微信开放文档 (qq.com)](https://developers.weixin.qq.com/miniprogram/dev/devtools/stable.html)

## 主界面

**小程序开发工具主界面**包括菜单栏、工具栏、模拟器、目录树、编辑区、调试器六大部分。

### **菜单栏**:

> 可以访问微信开发者工具的大部分功能：
>
> - 项目：用于新建项目或打开一个现有的项目。
> - 文件：用于新建文件、保存文件或关闭文件。
> - 编辑：用于编辑代码，对代码进行格式化。
> - 工具：用于访问一些辅助工具。
> - 界面：用于控制界面中各部分的显示和隐藏。
> - 设置：用于对外观、快捷键、编辑器等进行设置。
> - 微信开发者工具：可以进行切换账号、更换开发模式、调试等操作

### **工具栏**:

> 提供了一些常用功能的快捷按钮：
>
> - 个人中心：位于工具栏最左侧第1个按钮，显示当前登录用户头像。
> - 模拟器、编辑器和调试器：用于控制相应工具的显示和隐藏。
> - 云开发：开发者可以使用云开发来开发小程序、小游戏。云开发能力从基础库2.2.3开始支持。
> - 模式切换下拉菜单：用于在小程序模式搜索动态页和插件模式之间切换。
> - 编译下拉菜单：用于切换编译模式，默认为普通编译。
> - 编译：编写小程序的代码后，需要编译才能运行。
> - 预览：单击预览按钮会生成一个二维码，使用手机中的微信扫描二维码。
> - 真机调试：通过网络连接对手机上运行的小程序进行调试。
> - 切后台：用于模拟小程序在手机中切后台的效果。
> - 清缓存：用于清除数据缓存、文件缓存等。
> - 上传：用于将代码上传到小程序管理后台。
> - 版本管理：用于通过Git对小程序进行版本管理。

### **模拟器**:

> 模拟器用于模拟手机环境，查看不同型号手机的运行效果

### **目录树**:

> 可以查看文件目录结构

### **编辑区**:

> 可以编辑文件代码

### **调试器**:

> 调试器类似于Google Chrome浏览器中的开发者工具：
>
> - Console：控制台面板，用于输出调试信息，也可以直接编写代码执行。
> - Sources：源代码面板，可以查看或编辑源代码，并支持代码调试。
> - Network：网络面板，记录网络请求信息，根据它可进行网络性能优化。
> - Security：安全面板，用于调试页面的安全和认证等信息，如HTTpS。
> - AppData：App数据面板，可以查看或编辑当前小程序运行时的数据。
> - Audits：审计面板，用于对小程序进行体验评分。
> - Sensor：传感器面板，用于模拟地理位置、重力感应。 
> - Storage：存储面板，用于查看和管理本地数据缓存。
> - Trace：跟踪面板，用于真机调试时跟踪调试信息。
> - Wxml：Wxml面板，用于查看和调试WXML和WXSS。

## 小程序文件类型

文件类型主要有: 
 **\*.json**：配置文件 

> 主要用于配置小程序的全局配置和页面配置等，如小程序的窗口背景色、页面路径等。

 **\*.wxml**: 模板文件 

> 用于描述小程序的界面结构，包括布局、组件、数据绑定等。

**\*.wxss**：样式文件 

> 用于描述小程序的样式，包括字体、颜色、布局等。

**\*.ts/\*.js**：逻辑文件 

> 用于处理小程序的业务逻辑、事件处理等，包括数据处理、网络请求等。

<img src="轻量化平台开发笔记.assets/image-20230309202016911.png" alt="image-20230309202016911" style="zoom: 80%;" />

| **路径**               | **说明**                       |
| ---------------------- | ------------------------------ |
| project.config.json    | 项目配置文件                   |
| app.js                 | 应用程序的逻辑文件             |
| app.json               | 应用程序的配置文件             |
| app.wxss               | 应用程序公共样式文件           |
| pages/                 | 存放页面文件目录               |
| pages/index/           | 存放index页面的目录            |
| pages/index/index.ts   | Index页面的逻辑文件            |
| pages/index/index.json | Index页面的配置文件            |
| pages/index/index.wxml | Index页面的结构文件            |
| pages/index/index.wxss | Index页面的样式文件            |
| pages/logs/            | 存放logs页面的目录             |
| pages/logs/logs.ts     | logs页面的逻辑文件             |
| pages/logs/logs.json   | logs页面的配置文件             |
| pages/logs/logs.wxml   | logs页面的结构文件             |
| pages/logs/logs.wxss   | logs页面的样式文件             |
| utils/                 | 存放公共脚本文件的目录         |
| utils/utils.js         | 公共脚本文件，保存一些工具代码 |

# 开发基础

## 页面组件

| **标签** | **功能** | **标签**   | **功能** |
| -------- | -------- | ---------- | -------- |
| <view>   | 视图容器 | <icon>     | 图标文件 |
| <text>   | 文本域   | <checkbox> | 复选框   |
| <button> | 按钮     | <radio>    | 单选框   |
| <image>  | 图片     | <input>    | 输入框   |
| <form>   | 表单     | <progress> | 进度条   |

## 页面样式

### 选择器

| **选择器**        | **示例**     | **说明**                        |
| ----------------- | ------------ | ------------------------------- |
| .class            | .container   | 选择所有class="container"的组件 |
| #id               | #id          | 选择id="#id"的组件              |
| element           | view         | 选择所有view组件                |
| element,  element | view,  text  | 选择所有view组件和所有text组件  |
| ::after           | view::after  | 在view组件内的后面插入内容      |
| ::before          | view::before | 在view组件内的前面插入内容      |

<img src="轻量化平台开发笔记.assets/image-20230309204322553.png" alt="image-20230309204322553" style="zoom:50%;" />

### px和rpx

px-物理像素：指屏幕上实际有多少个像素。

rpx-逻辑像素：是指CSS中使用的像素单位。

## 配置文件

**页面级配置文件 - index.json**

| **属性**                     | **说明**                                                   |
| ---------------------------- | ---------------------------------------------------------- |
| navigationBarBackgroundColor | 导航栏背景颜色，默认为“#000000”                            |
| navigationBarTextStyle       | 导航栏标题颜色，仅支持black、white（默认）                 |
| navigationBarTitleText       | 导航栏的标题文字内容                                       |
| backgroundColor              | 窗口的背景色，默认为“#ffffff”                              |
| backgroundTextStyle          | 下拉loading的样式，仅支持dark（默认）、light               |
| enablePullDownRefresh        | 是否全局开启下拉刷新，默认为false                          |
| onReachBottomDistance        | 页面上拉触底事件触发时距页面底部距离（单位为px），默认为50 |
| disableScroll                | 默认为false。设为true时，页面整体不能上下滚动              |

**应用级配置文件 – app.json**

| **属性**                | **说明**                                       |
| ----------------------- | ---------------------------------------------- |
| pages                   | 页面路径列表                                   |
| window                  | 全局的默认窗口表现，可以一次设置多个页面级配置 |
| tabBar                  | 底部 tab 栏的表现                              |
| networkTimeout          | 网络超时时间                                   |
| debug                   | 是否开启调试模式，默认为false                  |
| requiredBackgroundModes | 需要在后台使用的能力，如“音乐播放”             |
| plugins                 | 使用到的插件                                   |

| **属性**      | **类型** | **说明**                                          |
| ------------- | -------- | ------------------------------------------------- |
| request       | Number   | wx.request()的超时时间（毫秒），默认为60000       |
| connectSocket | Number   | wx.connectSocket()的超时时间（毫秒），默认为60000 |
| uploadFile    | Number   | wx.uploadFile()的超时时间（毫秒），默认为60000    |
| downloadFile  | Number   | wx.downloadFile()的超时时间（毫秒），默认为60000  |

## 页面逻辑

### 生命周期

微信小程序的生命周期分为两个部分：应用生命周期和页面生命周期。

1. 应用生命周期：

- onLaunch(options)：小程序初始化时触发，只执行一次，可以在此获取小程序启动时的参数。
- onShow(options)：小程序启动或从后台进入前台时触发。
- onHide()：小程序从前台进入后台时触发。
- onError(error)：小程序发生脚本错误或 API 调用失败时触发。

1. 页面生命周期：

- onLoad(options)：页面加载时触发，可以在此获取页面参数。
- onShow()：页面显示时触发。
- onReady()：页面初次渲染完成时触发。
- onHide()：页面从前台进入后台时触发。
- onUnload()：页面卸载时触发。

除了上述生命周期函数，还有一些特殊的生命周期函数，例如：

- onPullDownRefresh()：页面下拉刷新时触发。
- onReachBottom()：页面上拉触底时触发。
- onPageScroll(Object)：页面滚动时触发。

**状态模式-单向数据流。**
状态模式定义一个对象，改对象可以通过管理其状态的变化，从而实现应用程序做出相应的变化。

<img src="轻量化平台开发笔记.assets/image-20230316201623494.png" alt="image-20230316201623494" style="zoom:50%;" />

| **属性**      | **说明**                       |
| ------------- | ------------------------------ |
| type          | 事件类型                       |
| timeStamp     | 事件生成时间戳                 |
| target        | 触发事件的组件的一些属性值集合 |
| currentTarget | 当前组件的一些属性集合         |
| detail        | 额外的信息                     |

## 冒泡

冒泡事件是指当一个组件上的事件被触发后，事件会向父节点传递，而非冒泡事件不会向父节点传递。

生命周期回调函数的区别分析如下：
点击outer => outer – outer
点击inner => inner - outer

```html
<view bindtap="viewtap" id="outer">
  outer
  <view id="inner">inner</view>
</view>
viewtap: function(e) {
  console.log(e.target.id + '-' + e.currentTarget.id)
}
```

| **属性**    | **类型**                                                     |
| ----------- | ------------------------------------------------------------ |
| touchstart  | 手指触摸动作开始                                             |
| touchmove   | 手指触摸后移动                                               |
| touchcancel | 手指触摸动作被打断，如来电提醒，弹窗                         |
| touchend    | 手指触摸动作结束                                             |
| tap         | 手指触摸后马上离开                                           |
| longpress   | 手指触摸后，超过350ms再离开。如果指定了事件回调函数并触发了这个事件，tap事件将不被触发 |